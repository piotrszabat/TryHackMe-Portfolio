Answers to Windows Network Analysis room.

Task 1-1
Click me to proceed on to the next task.
No answer needed

=====

Task 2-1
What is the full name of the Windows feature that tracks the last 30 to 60 days of system statistics?
Answer is: System Resource Usage Monitor

Task 2-2
What is the full path to the directory that Windows will output Firewall logs to?
Answer is: C:\Windows\System32\LogFiles\Firewall

=====

Task 3-1
What cmdlet can be used to display active TCP connections?
Answer is: Get-NetTCPConnection

Task 3-2
What cmdlet can be used to display the DNS cache on the host?
Answer is: Get-DnsClientCache

Task 3-3
What command can be used to list all active RDP sessions on the host?
Answer is: qwinsta

=====

Task 4-1
What netstat flag can we use to display the executable responsible for a connection?
Answer is: -b

Task 4-2
If we wanted to display all TCP connections and the associated process ID using netstat, what flag would we use?
Answer is: -o

Task 4-3
What special character can we use to save the output of netstat to a text file?
Answer is: >

=====

Task 5-1
Use the Get-NetTCPConnection PowerShell cmdlet to list the connections currently active.
A popular port for reverse shells is currently active. What is the port number?
If nothing sticks out, wait a few minutes and run the command again.
Answer is: 4444

Task 5-2
What is the name of the process that is connecting to the C2 server?
Answer is: pythonw.exe

Task 5-3
What is the domain that has been added to the workstation's host file?
Answer is: attackerc2.thm

Task 5-4
Analyse the SRUM database. There is another process that has sent a large amount of bytes, indicating data exfil. What is the full path to the process (as listed in SRUM)?
Answer is: \device\harddiskvolume3\program files\updater\exfil.exe

Task 5-5
Finally, analyse the SMB shares present on the analyst machine. What is the name of the share that stands out?
Answer is: confidential

=====

Task 6-1
Terminate the machines in both rooms and complete this task when you are finished.
No answer needed

